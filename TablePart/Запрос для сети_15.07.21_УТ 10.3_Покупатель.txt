ТекстЗапроса = "ВЫБРАТЬ
               |    """" КАК Пометка,
               |    ВЫБОР
               |         КОГДА ТИПЗНАЧЕНИЯ(ЭКОМ_ЦепочкаПокупателя.СЧФ) = ТИП(Документ.СчетФактураПолученный)
               |                   И НЕ ЭКОМ_ЦепочкаПокупателя.СЧФ = ЗНАЧЕНИЕ(Документ.СчетФактураПолученный.ПустаяСсылка)
               |              ТОГДА ЭКОМ_ЦепочкаПокупателя.СЧФ
               |         КОГДА ТИПЗНАЧЕНИЯ(ЭКОМ_ЦепочкаПокупателя.Накладная) = ТИП(Документ.ПоступлениеТоваровУслуг)
               |                   И НЕ ЭКОМ_ЦепочкаПокупателя.Накладная = ЗНАЧЕНИЕ(Документ.ПоступлениеТоваровУслуг.ПустаяСсылка)
               |              ТОГДА ЭКОМ_ЦепочкаПокупателя.Накладная
               |         КОГДА ТИПЗНАЧЕНИЯ(ЭКОМ_ЦепочкаПокупателя.DESADV) = ТИП(Документ.ЭКОМ_Документы)
               |                   И НЕ ЭКОМ_ЦепочкаПокупателя.DESADV = ЗНАЧЕНИЕ(Документ.ЭКОМ_Документы.ПустаяСсылка)
               |              ТОГДА ЭКОМ_ЦепочкаПокупателя.DESADV
               |         КОГДА ТИПЗНАЧЕНИЯ(ЭКОМ_ЦепочкаПокупателя.ORDRSP) = ТИП(Документ.ЭКОМ_Документы)
               |                   И НЕ ЭКОМ_ЦепочкаПокупателя.ORDRSP = ЗНАЧЕНИЕ(Документ.ЭКОМ_Документы.ПустаяСсылка)
               |              ТОГДА ЭКОМ_ЦепочкаПокупателя.ORDRSP
               |         ИНАЧЕ ЭКОМ_ЦепочкаПокупателя.Заказ
               |    КОНЕЦ КАК ДокументыВсе,
               |    ЭКОМ_ЦепочкаПокупателя.ORDERDATE КАК ДатаЗаказа,
               |    ЭКОМ_ЦепочкаПокупателя.ORDERNUMBER КАК НомерЗаказа,
               |    ЭКОМ_ЦепочкаПокупателя.Заказ КАК ДокументЗаказа,
               |    ЭКОМ_ЦепочкаПокупателя.ORDRSP КАК ЭКОМ_Документ_ORDRSP,
               |    ВЫБОР
               |         КОГДА НЕ(ЭКОМ_ЦепочкаПокупателя.ORDRSP.Комментарий ЕСТЬ NULL
               |                        ИЛИ (ВЫРАЗИТЬ(ЭКОМ_ЦепочкаПокупателя.ORDRSP.Комментарий КАК СТРОКА(10))) = """")
               |              ТОГДА 0
               |         ИНАЧЕ -1
               |    КОНЕЦ КАК ЭКОМ_Документ_ORDRSP__КартинкаИнформация,
               |    ЭКОМ_ЦепочкаПокупателя.DESADV КАК ЭКОМ_Документ_DESADV,
               |    ВЫБОР
               |         КОГДА НЕ(ЭКОМ_ЦепочкаПокупателя.DESADV.Комментарий ЕСТЬ NULL
               |                        ИЛИ (ВЫРАЗИТЬ(ЭКОМ_ЦепочкаПокупателя.DESADV.Комментарий КАК СТРОКА(10))) = """")
               |              ТОГДА 0
               |         ИНАЧЕ -1
               |    КОНЕЦ КАК ЭКОМ_Документ_DESADV__КартинкаИнформация,
               |    ЭКОМ_ЦепочкаПокупателя.ВозвратнаяНакладная КАК ВозвратТоваровПоставщику,
               |    ЭКОМ_ЦепочкаПокупателя.Накладная КАК ДокументПоступления,
               |    ВЫБОР
               |         КОГДА ЭКОМ_ЦепочкаПокупателя.ЮЗД_Основание = ЗНАЧЕНИЕ(Документ.ЭКОМ_Документы.ПустаяСсылка)
               |              ТОГДА НЕОПРЕДЕЛЕНО
               |         ИНАЧЕ ЭКОМ_ЦепочкаПокупателя.Накладная
               |    КОНЕЦ КАК КорректировкаПоступления,
               |    ЭКОМ_ЦепочкаПокупателя.ДатаПоставки КАК ДатаПоставки,
               |    ЭКОМ_ЦепочкаПокупателя.КоличествоЗаказ КАК Заказано,
               |    ЭКОМ_ЦепочкаПокупателя.КоличествоORDRSP КАК Подтверждено,
               |    ЭКОМ_ЦепочкаПокупателя.КоличествоНакладная КАК Принято,
               |    ЭКОМ_ЦепочкаПокупателя.КоличествоDESADV КАК Отгружено,
               |    ЭКОМ_ЦепочкаПокупателя.Контрагент КАК Контрагент,
               |    ЭКОМ_ЦепочкаПокупателя.Организация КАК Организация,
               |    ЭКОМ_ЦепочкаПокупателя.ТочкаДоставки КАК ТочкаДоставки,
               |    ЭКОМ_ЦепочкаПокупателя.НомерИсправления КАК НомерИсправления,
               |    ЭКОМ_ЦепочкаПокупателя.Статус_DESADV КАК Статус_DESADV,
               |    ЭКОМ_ЦепочкаПокупателя.Статус_ORDER КАК Статус_ORDER,
               |    ЭКОМ_ЦепочкаПокупателя.Статус_ORDRSP КАК Статус_ORDRSP,
               |    ЭКОМ_ЦепочкаПокупателя.Статус_RECADV КАК Статус_RECADV,
			   |	ЭКОМ_ЦепочкаПокупателя.Статус_RETANN КАК Статус_RETANN,
			   |	ЭКОМ_ЦепочкаПокупателя.Статус_RETINS КАК Статус_RETINS,
               |    ВЫРАЗИТЬ(ЭКОМ_ЦепочкаПокупателя.СуммаЗаказ КАК ЧИСЛО(15, 2)) КАК СуммаЗаказ,
               |    ВЫРАЗИТЬ(ЭКОМ_ЦепочкаПокупателя.СуммаНакладная КАК ЧИСЛО(15, 2)) КАК СуммаНакладная,
               |    ВЫРАЗИТЬ(ЭКОМ_ЦепочкаПокупателя.СуммаСЧФ КАК ЧИСЛО(15, 2)) КАК СуммаСЧФ,
               |    ЭКОМ_ЦепочкаПокупателя.ТекстОшибки КАК ТекстОшибки,
               |    ЭКОМ_ЦепочкаПокупателя.ЮЗД КАК ДокументЭКОМ_ЮЗД,
			   |    ВЫБОР
               |         КОГДА НЕ(ЭКОМ_ЦепочкаПокупателя.ЮЗД.Комментарий ЕСТЬ NULL
               |                        ИЛИ (ВЫРАЗИТЬ(ЭКОМ_ЦепочкаПокупателя.ЮЗД.Комментарий КАК СТРОКА(10))) = """")
               |              ТОГДА 0
               |         ИНАЧЕ -1
               |    КОНЕЦ КАК ДокументЭКОМ_ЮЗД__КартинкаИнформация,
               |    ЭКОМ_ЦепочкаПокупателя.СтатусЮЗД КАК Статус_УПД,
               |    ВЫБОР
               |         КОГДА ТИПЗНАЧЕНИЯ(ЭКОМ_ЦепочкаПокупателя.СЧФ) = ТИП(Документ.СчетФактураПолученный)
               |                   И НЕ ЭКОМ_ЦепочкаПокупателя.СЧФ = ЗНАЧЕНИЕ(Документ.СчетФактураПолученный.ПустаяСсылка)
               |              ТОГДА ЭКОМ_ЦепочкаПокупателя.СЧФ
               |         КОГДА ТИПЗНАЧЕНИЯ(ЭКОМ_ЦепочкаПокупателя.Накладная) = ТИП(Документ.ПоступлениеТоваровУслуг)
               |                   И НЕ ЭКОМ_ЦепочкаПокупателя.Накладная = ЗНАЧЕНИЕ(Документ.ПоступлениеТоваровУслуг.ПустаяСсылка)
               |              ТОГДА ЭКОМ_ЦепочкаПокупателя.Накладная
               |         КОГДА ТИПЗНАЧЕНИЯ(ЭКОМ_ЦепочкаПокупателя.DESADV) = ТИП(Документ.ЭКОМ_Документы)
               |                   И НЕ ЭКОМ_ЦепочкаПокупателя.DESADV = ЗНАЧЕНИЕ(Документ.ЭКОМ_Документы.ПустаяСсылка)
               |              ТОГДА ЭКОМ_ЦепочкаПокупателя.DESADV
               |         КОГДА ТИПЗНАЧЕНИЯ(ЭКОМ_ЦепочкаПокупателя.ORDRSP) = ТИП(Документ.ЭКОМ_Документы)
               |                   И НЕ ЭКОМ_ЦепочкаПокупателя.ORDRSP = ЗНАЧЕНИЕ(Документ.ЭКОМ_Документы.ПустаяСсылка)
               |              ТОГДА ЭКОМ_ЦепочкаПокупателя.ORDRSP
               |         ИНАЧЕ ЭКОМ_ЦепочкаПокупателя.Заказ
               |    КОНЕЦ КАК Ссылка,
               |    ЭКОМ_ЦепочкаПокупателя.СЧФ КАК ДокументСЧФ,
               |    ВЫБОР
               |         КОГДА НЕ ЭКОМ_ЦепочкаПокупателя.ТекстОшибки = """"
               |              ТОГДА ИСТИНА
               |         ИНАЧЕ ЛОЖЬ
               |    КОНЕЦ КАК ЕстьОшибка,
               |    ВЫРАЗИТЬ(ЭКОМ_ЦепочкаПокупателя.ЮЗД.СуммаДокументаВсего КАК ЧИСЛО(15, 2)) КАК СуммаЮЗД_XML,
               |    ЭКОМ_ЦепочкаПокупателя.ЮЗД.СЧФНомер КАК СЧФ_Номер,
               |    ЭКОМ_ЦепочкаПокупателя.ЮЗД.СЧФДата КАК СЧФ_Дата,
               |    ВЫРАЗИТЬ(ВЫБОР
               |              КОГДА ЭКОМ_ЦепочкаПокупателя.СуммаНакладная - ЭКОМ_ЦепочкаПокупателя.ЮЗД.СуммаДокументаВсего > 0
               |                   ТОГДА ЭКОМ_ЦепочкаПокупателя.СуммаНакладная - ЭКОМ_ЦепочкаПокупателя.ЮЗД.СуммаДокументаВсего
               |              ИНАЧЕ -(ЭКОМ_ЦепочкаПокупателя.СуммаНакладная - ЭКОМ_ЦепочкаПокупателя.ЮЗД.СуммаДокументаВсего)
               |         КОНЕЦ КАК ЧИСЛО(15, 2)) КАК Дельта,
               |    ЭКОМ_ЦепочкаПокупателя.Статус_STATUS КАК Статус_STATUS,
               |    ВЫБОР
               |         КОГДА ЭКОМ_ЦепочкаПокупателя.ЮЗД.ВидДокумента В (ЗНАЧЕНИЕ(Перечисление.ЭКОМ_ВидыДокументов.ON_NSCHFDOPPRPROS_01), ЗНАЧЕНИЕ(Перечисление.ЭКОМ_ВидыДокументов.ON_NSCHFDOPPRMARK_01), ЗНАЧЕНИЕ(Перечисление.ЭКОМ_ВидыДокументов.ON_NSCHFDOPPRPROS_01_Испр), ЗНАЧЕНИЕ(Перечисление.ЭКОМ_ВидыДокументов.ON_NSCHFDOPPRMARK_01_Испр))
               |              ТОГДА ИСТИНА
               |         КОГДА ЭКОМ_ЦепочкаПокупателя.ЮЗД_Основание.ВидДокумента В (ЗНАЧЕНИЕ(Перечисление.ЭКОМ_ВидыДокументов.ON_NSCHFDOPPRPROS_01), ЗНАЧЕНИЕ(Перечисление.ЭКОМ_ВидыДокументов.ON_NSCHFDOPPRMARK_01), ЗНАЧЕНИЕ(Перечисление.ЭКОМ_ВидыДокументов.ON_NSCHFDOPPRPROS_01_Испр), ЗНАЧЕНИЕ(Перечисление.ЭКОМ_ВидыДокументов.ON_NSCHFDOPPRMARK_01_Испр))
               |              ТОГДА ИСТИНА
               |         ИНАЧЕ ЛОЖЬ
               |    КОНЕЦ КАК ЭтоМаркируемыйЮЗД,
               |    ЭКОМ_ЦепочкаПокупателя.ЮЗД.ВидДокумента КАК ЮЗДВидДокумента,
               |    ЭКОМ_ЦепочкаПокупателя.ЮЗД.ИнформацияПоДокументу КАК СтатусДокументооборота,
               |    ЭКОМ_ЦепочкаПокупателя.ТекстОтклоненияАннулирования КАК ТекстОтклоненияАннулирования,
               |    ЭКОМ_ЦепочкаПокупателя.ЮЗД.Комментарий КАК ТекстУточнения,
               |    ЭКОМ_ЦепочкаПокупателя.ТекстПричиныАннулирования КАК ТекстПричиныАннулирования
               |ИЗ
               |    РегистрСведений.ЭКОМ_ЦепочкиДокументовПокупателя КАК ЭКОМ_ЦепочкаПокупателя
               |ГДЕ
               |    ЭКОМ_ЦепочкаПокупателя.ORDERDATE МЕЖДУ &ДатаНач И &ДатаКон";
