ТекстЗапроса = "ВЫБРАТЬ
               |	"""" КАК Пометка,
               |    ЭКОМ_ЦепочкиДокументовПоставщика.ORDERNUMBER КАК НомерЗаказа,
               |	ЭКОМ_ЦепочкиДокументовПоставщика.ORDERDATE КАК ДатаЗаказа,
               |	ЭКОМ_ЦепочкиДокументовПоставщика.ORDER КАК ЭКОМ_Документ_ORDER,
               |	ВЫБОР
               |		КОГДА НЕ(ЭКОМ_ЦепочкиДокументовПоставщика.ORDER.Комментарий ЕСТЬ NULL
               |					ИЛИ (ВЫРАЗИТЬ(ЭКОМ_ЦепочкиДокументовПоставщика.ORDER.Комментарий КАК СТРОКА(10))) = """")
               |			ТОГДА 0
               |		ИНАЧЕ -1
               |	КОНЕЦ КАК ЭКОМ_Документ_ORDER__КартинкаИнформация,
               |	ЭКОМ_ЦепочкиДокументовПоставщика.Заказ КАК ДокументЗаказа,
               |	ЭКОМ_ЦепочкиДокументовПоставщика.Накладная КАК ДокументРеализации,
               |	ЭКОМ_ЦепочкиДокументовПоставщика.RECADV КАК ЭКОМ_Документ_RECADV,
               |	ВЫБОР
               |		КОГДА НЕ(ЭКОМ_ЦепочкиДокументовПоставщика.RECADV.Комментарий ЕСТЬ NULL
               |					ИЛИ (ВЫРАЗИТЬ(ЭКОМ_ЦепочкиДокументовПоставщика.RECADV.Комментарий КАК СТРОКА(10))) = """")
               |			ТОГДА 0
               |		ИНАЧЕ -1
               |	КОНЕЦ КАК ЭКОМ_Документ_RECADV__КартинкаИнформация,
               |	ЭКОМ_ЦепочкиДокументовПоставщика.RETANN КАК ЭКОМ_Документ_RETANN,
               |	ВЫБОР
               |		КОГДА НЕ(ЭКОМ_ЦепочкиДокументовПоставщика.RETANN.Комментарий ЕСТЬ NULL
               |					ИЛИ (ВЫРАЗИТЬ(ЭКОМ_ЦепочкиДокументовПоставщика.RETANN.Комментарий КАК СТРОКА(10))) = """")
               |			ТОГДА 0
               |		ИНАЧЕ -1
               |	КОНЕЦ КАК ЭКОМ_Документ_RETANN__КартинкаИнформация,
               |	ЭКОМ_ЦепочкиДокументовПоставщика.Накладная_Кор КАК КорректировкаРеализации,
               |	ВЫБОР
               |		КОГДА ЭКОМ_ЦепочкиДокументовПоставщика.СЧФ_Кор = &СЧФ_ПустаяСсылка
               |			ТОГДА ЭКОМ_ЦепочкиДокументовПоставщика.СЧФ
               |		ИНАЧЕ ЭКОМ_ЦепочкиДокументовПоставщика.СЧФ_Кор
               |	КОНЕЦ КАК ДокументСЧФ,
               |	ЭКОМ_ЦепочкиДокументовПоставщика.НомерИсправления КАК НомерИсправления,
               |	ЭКОМ_ЦепочкиДокументовПоставщика.ВозвратнаяНакладная КАК ВозвратТоваровОтПокупателя,
               |	ЭКОМ_ЦепочкиДокументовПоставщика.ДатаПоставки КАК ДатаПоставки,
               |	ЭКОМ_ЦепочкиДокументовПоставщика.Организация КАК Организация,
               |	ЭКОМ_ЦепочкиДокументовПоставщика.Контрагент КАК Контрагент,
               |	ЭКОМ_ЦепочкиДокументовПоставщика.ТочкаДоставки КАК ТочкаДоставки,
               |	ЭКОМ_ЦепочкиДокументовПоставщика.СЧФ КАК СЧФ,
               |	ЭКОМ_ЦепочкиДокументовПоставщика.СЧФ_Кор КАК СЧФ_Кор,
               |	ЭКОМ_ЦепочкиДокументовПоставщика.Статус_ORDER КАК Статус_ORDER,
               |	ЭКОМ_ЦепочкиДокументовПоставщика.Статус_ORDRSP КАК Статус_ORDRSP,
               |	ЭКОМ_ЦепочкиДокументовПоставщика.Статус_DESADV КАК Статус_DESADV,
               |	ЭКОМ_ЦепочкиДокументовПоставщика.Статус_DESSCC КАК Статус_DESSCC,
               |	ЭКОМ_ЦепочкиДокументовПоставщика.Статус_RECADV КАК Статус_RECADV,
               |	ЭКОМ_ЦепочкиДокументовПоставщика.Статус_RETANN КАК Статус_RETANN,
               |	ЭКОМ_ЦепочкиДокументовПоставщика.Статус_RETINS КАК Статус_RETINS, 
               |	ЭКОМ_ЦепочкиДокументовПоставщика.Статус_INVOICE КАК Статус_INVOICE,
               |	ЭКОМ_ЦепочкиДокументовПоставщика.СтатусЮЗД КАК Статус_УПД,
               |	ЭКОМ_ЦепочкиДокументовПоставщика.Статус_Палеты КАК Палеты,
               |	ЭКОМ_ЦепочкиДокументовПоставщика.ТекстОшибки КАК ТекстОшибки,
               |	ВЫБОР
               |		КОГДА НЕ ЭКОМ_ЦепочкиДокументовПоставщика.СЧФ_Кор = &СЧФ_ПустаяСсылка
               |			ТОГДА ЭКОМ_ЦепочкиДокументовПоставщика.СЧФ_Кор
               |		КОГДА НЕ ЭКОМ_ЦепочкиДокументовПоставщика.Накладная_Кор = &Накладная_Кор_ПустаяСсылка
               |			ТОГДА ЭКОМ_ЦепочкиДокументовПоставщика.Накладная_Кор
               |		КОГДА НЕ ЭКОМ_ЦепочкиДокументовПоставщика.СЧФ = &СЧФ_ПустаяСсылка
               |			ТОГДА ЭКОМ_ЦепочкиДокументовПоставщика.СЧФ
               |		КОГДА НЕ ЭКОМ_ЦепочкиДокументовПоставщика.RECADV = &RECADV_ПустаяСсылка
               |			ТОГДА ЭКОМ_ЦепочкиДокументовПоставщика.RECADV
               |		КОГДА НЕ ЭКОМ_ЦепочкиДокументовПоставщика.Накладная = &Накладная_ПустаяСсылка
               |			ТОГДА ЭКОМ_ЦепочкиДокументовПоставщика.Накладная
               |		КОГДА НЕ ЭКОМ_ЦепочкиДокументовПоставщика.Заказ = &Заказ_ПустаяСсылка
               |			ТОГДА ЭКОМ_ЦепочкиДокументовПоставщика.Заказ
               |		ИНАЧЕ ЭКОМ_ЦепочкиДокументовПоставщика.ORDER
               |	КОНЕЦ КАК Ссылка,
               |	ВЫРАЗИТЬ(ВЫБОР
               |			КОГДА НЕ ЭКОМ_ЦепочкиДокументовПоставщика.СуммаСЧФ_Кор = 0
               |				ТОГДА ЭКОМ_ЦепочкиДокументовПоставщика.СуммаСЧФ_Кор
               |			ИНАЧЕ ЭКОМ_ЦепочкиДокументовПоставщика.СуммаСЧФ
               |		КОНЕЦ КАК ЧИСЛО(15, 2)) КАК СуммаСЧФ,
               |	ЭКОМ_ЦепочкиДокументовПоставщика.КоличествоORDER КАК Заказано,
               |	ЭКОМ_ЦепочкиДокументовПоставщика.КоличествоЗаказ КАК Подтверждено,
               |	ВЫБОР
               |		КОГДА НЕ ЭКОМ_ЦепочкиДокументовПоставщика.КоличествоНакладная_Кор = 0
               |			ТОГДА ЭКОМ_ЦепочкиДокументовПоставщика.КоличествоНакладная_Кор
               |		ИНАЧЕ ЭКОМ_ЦепочкиДокументовПоставщика.КоличествоНакладная
               |	КОНЕЦ КАК Отгружено,
               |	ЭКОМ_ЦепочкиДокументовПоставщика.КоличествоRECADV КАК Принято,
               |	ЗНАЧЕНИЕ(Перечисление.ЭКОМ_Статусы.ПустаяСсылка) КАК Статус,
               |	ВЫБОР
               |		КОГДА НЕ ЭКОМ_ЦепочкиДокументовПоставщика.ТекстОшибки = """"
               |			ТОГДА ИСТИНА
               |		ИНАЧЕ ЛОЖЬ
               |	КОНЕЦ КАК ЕстьОшибка,
               |	ВЫБОР
               |		КОГДА ЕСТЬNULL(ЭКОМ_ЦепочкиДокументовПоставщика.КоличествоНакладная, 0) <> ЕСТЬNULL(ЭКОМ_ЦепочкиДокументовПоставщика.КоличествоRECADV, 0)
               |				И ЭКОМ_ЦепочкиДокументовПоставщика.Статус_RECADV
               |			ТОГДА ИСТИНА
               |		ИНАЧЕ ЛОЖЬ
               |	КОНЕЦ КАК ЕстьРасхождение,
               |	ВЫБОР
               |		КОГДА ЭКОМ_ЦепочкиДокументовПоставщика.СЧФ_Кор.ВидСчетаФактуры = ЗНАЧЕНИЕ(Перечисление.ВидСчетаФактурыВыставленного.Корректировочный)
               |			ТОГДА ЭКОМ_ЦепочкиДокументовПоставщика.СЧФ_Кор
               |	КОНЕЦ КАК СчетФактураКорректировочная,
               |	ВЫБОР
               |		КОГДА ЭКОМ_ЦепочкиДокументовПоставщика.СЧФ_Кор.Исправление
               |			ТОГДА ЭКОМ_ЦепочкиДокументовПоставщика.СЧФ_Кор
               |	КОНЕЦ КАК СчетФактураИсправительная,
               |	ЭКОМ_ЦепочкиДокументовПоставщика.СЧФ КАК СчетФактураИсходная,
               |	ЭКОМ_ЦепочкиДокументовПоставщика.Статус_Транспорт КАК Транспорт,
               |	ЭКОМ_ЦепочкиДокументовПоставщика.Статус_STATUS,
               |	ЭКОМ_ЦепочкиДокументовПоставщика.ТекстОтклоненияАннулирования,
               |	ЭКОМ_ЦепочкиДокументовПоставщика.ТекстПричиныАннулирования,
               |    ЭКОМ_Объекты_СобытияУточнение.ТекстОшибки КАК ТекстУточнения
               |ИЗ
               |	РегистрСведений.ЭКОМ_ЦепочкиДокументовПоставщика КАК ЭКОМ_ЦепочкиДокументовПоставщика
               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЭКОМ_Объекты_События КАК ЭКОМ_Объекты_СобытияУточнение
               |		ПО ЭКОМ_ЦепочкиДокументовПоставщика.СЧФ = ЭКОМ_Объекты_СобытияУточнение.Документ_Основание
               |			И (ЭКОМ_Объекты_СобытияУточнение.ВидДокумента = ЗНАЧЕНИЕ(Перечисление.ЭКОМ_ВидыДокументов.DP_UVUTOCH_09))
               |ГДЕ
               |	ЭКОМ_ЦепочкиДокументовПоставщика.ORDERDATE МЕЖДУ &ДатаНач И &ДатаКон";

// Необходимо указать типы документов для конфигурации 1С.
ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&Заказ_ПустаяСсылка", 		"Значение(Документ.ЗаказПокупателя.ПустаяСсылка)");
ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&СЧФ_ПустаяСсылка", 			"Значение(Документ.СчетФактураВыданный.ПустаяСсылка)");
ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&Накладная_ПустаяСсылка", 	"Значение(Документ.РеализацияТоваровУслуг.ПустаяСсылка)");
ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&Накладная_Кор_ПустаяСсылка", "Значение(Документ.КорректировкаРеализации.ПустаяСсылка)");
ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&RECADV_ПустаяСсылка", 		"Значение(Документ.ЭКОМ_Документы.ПустаяСсылка)");

