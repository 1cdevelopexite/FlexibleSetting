ТекстЗапроса = 
"ВЫБРАТЬ
|	ЭКОМ_ЦепочкиДокументовПоставщика.ORDERNUMBER КАК НомерЗаказа,
|	ЭКОМ_ЦепочкиДокументовПоставщика.ORDERDATE КАК ДатаЗаказа,
|	ЭКОМ_ЦепочкиДокументовПоставщика.ORDER КАК ЭКОМ_Документ_ORDER,
|	ЭКОМ_ЦепочкиДокументовПоставщика.Заказ КАК ДокументЗаказа,
|	ЭКОМ_ЦепочкиДокументовПоставщика.Накладная КАК ДокументРеализации,
|	ЭКОМ_ЦепочкиДокументовПоставщика.RECADV КАК ЭКОМ_Документ_RECADV,
|	ЭКОМ_ЦепочкиДокументовПоставщика.Накладная_Кор КАК КорректировкаРеализации,
|	ЭКОМ_ЦепочкиДокументовПоставщика.СЧФ КАК ДокументСЧФ,
|	ЭКОМ_ЦепочкиДокументовПоставщика.ВозвратнаяНакладная КАК ВозвратТоваровОтПокупателя,
|	ЭКОМ_ЦепочкиДокументовПоставщика.ДатаПоставки КАК ДатаПоставки,
|	ЭКОМ_ЦепочкиДокументовПоставщика.Организация КАК Организация,
|	ЭКОМ_ЦепочкиДокументовПоставщика.Контрагент КАК Контрагент,
|	ЭКОМ_ЦепочкиДокументовПоставщика.ТочкаДоставки КАК ТочкаДоставки,
|	ЭКОМ_ЦепочкиДокументовПоставщика.Статус_ORDER КАК Статус_ORDER,
|	ЭКОМ_ЦепочкиДокументовПоставщика.Статус_ORDRSP КАК Статус_ORDRSP,
|	ЭКОМ_ЦепочкиДокументовПоставщика.Статус_DESADV КАК Статус_DESADV,
|	ЭКОМ_ЦепочкиДокументовПоставщика.Статус_DESSCC КАК Статус_DESSCC,
|	ЭКОМ_ЦепочкиДокументовПоставщика.Статус_RECADV КАК Статус_RECADV,
|	ЭКОМ_ЦепочкиДокументовПоставщика.Статус_INVOICE КАК Статус_INVOICE,
|	ВЫБОР
|		КОГДА ЭКОМ_ЦепочкиДокументовПоставщика.Статус_ON_KORSCHFDOPPOK_11
|				ИЛИ ЭКОМ_ЦепочкиДокументовПоставщика.Статус_ON_NSCHFDOPPOK_11
|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ЭКОМ_Статусы.ДокументооборотЗавершен)
|		КОГДА ЭКОМ_ЦепочкиДокументовПоставщика.Статус_DP_UVUTOCH_09
|				ИЛИ ЭКОМ_ЦепочкиДокументовПоставщика.Статус_DP_IZVPOL_10
|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ЭКОМ_Статусы.Уточнение)
|		КОГДА ЭКОМ_ЦепочкиДокументовПоставщика.Статус_DP_IZVPOL_06
|				ИЛИ ЭКОМ_ЦепочкиДокументовПоставщика.Статус_DP_IZVPOL_04
|				ИЛИ ЭКОМ_ЦепочкиДокументовПоставщика.Статус_DP_PDPOL_02
|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ЭКОМ_Статусы.ОжиданиеПодтверждения)
|		КОГДА ЭКОМ_ЦепочкиДокументовПоставщика.Статус_ON_KORSCHFDOPPR_01
|				ИЛИ ЭКОМ_ЦепочкиДокументовПоставщика.Статус_ON_NSCHFDOPPR_01
|				ИЛИ ЭКОМ_ЦепочкиДокументовПоставщика.Статус_ON_NSCHFDOPPR_01_Испр
|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ЭКОМ_Статусы.Отправлен)
|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ЭКОМ_Статусы.НеОбработан)
|	КОНЕЦ КАК Статус_УПД,
|	ЭКОМ_ЦепочкиДокументовПоставщика.Статус_Палеты КАК Палеты,
|	ЭКОМ_ЦепочкиДокументовПоставщика.НомерИсправления КАК НомерИсправления,
|	ЭКОМ_ЦепочкиДокументовПоставщика.ТекстОшибки КАК ТекстОшибки,
|	Уточнение.ТекстОшибки КАК ТекстУточнения,
|	ВЫБОР
|		КОГДА НЕ ЭКОМ_ЦепочкиДокументовПоставщика.Накладная_Кор = ЗНАЧЕНИЕ(Документ.КорректировкаРеализации.ПустаяСсылка)
|			ТОГДА ЭКОМ_ЦепочкиДокументовПоставщика.Накладная_Кор
|		КОГДА НЕ ЭКОМ_ЦепочкиДокументовПоставщика.СЧФ = ЗНАЧЕНИЕ(Документ.СчетФактураВыданный.ПустаяСсылка)
|			ТОГДА ЭКОМ_ЦепочкиДокументовПоставщика.СЧФ
|		КОГДА НЕ ЭКОМ_ЦепочкиДокументовПоставщика.RECADV = ЗНАЧЕНИЕ(Документ.ЭКОМ_Документы.ПустаяСсылка)
|			ТОГДА ЭКОМ_ЦепочкиДокументовПоставщика.RECADV
|		КОГДА НЕ ЭКОМ_ЦепочкиДокументовПоставщика.Накладная = ЗНАЧЕНИЕ(Документ.РеализацияТоваровУслуг.ПустаяСсылка)
|			ТОГДА ЭКОМ_ЦепочкиДокументовПоставщика.Накладная
|		КОГДА НЕ ЭКОМ_ЦепочкиДокументовПоставщика.Заказ = ЗНАЧЕНИЕ(Документ.ЗаказПокупателя.ПустаяСсылка)
|			ТОГДА ЭКОМ_ЦепочкиДокументовПоставщика.Заказ
|		ИНАЧЕ ЭКОМ_ЦепочкиДокументовПоставщика.ORDER
|	КОНЕЦ КАК Ссылка,
|	ЭКОМ_ЦепочкиДокументовПоставщика.СуммаСЧФ КАК СуммаСЧФ,
|	ЭКОМ_ЦепочкиДокументовПоставщика.КоличествоORDER КАК Заказано,
|	ЕСТЬNULL(ЭКОМ_ЦепочкиДокументовПоставщика.КоличествоЗаказ, ""-"") КАК Подтверждено,
|	ЕСТЬNULL(ВЫБОР
|			КОГДА НЕ ЭКОМ_ЦепочкиДокументовПоставщика.КоличествоНакладная_Кор = 0
|				ТОГДА ЭКОМ_ЦепочкиДокументовПоставщика.КоличествоНакладная_Кор
|			ИНАЧЕ ЭКОМ_ЦепочкиДокументовПоставщика.КоличествоНакладная
|		КОНЕЦ, ""-"") КАК Отгружено,
|	ЕСТЬNULL(ЭКОМ_ЦепочкиДокументовПоставщика.КоличествоRECADV, ""-"") КАК Принято,
|	ЭКОМ_GLN_Контрагент.Контрагент_УПДПоПриказу840 КАК УПД840,
|	ВЫБОР
|		КОГДА (ЭКОМ_ЦепочкиДокументовПоставщика.Статус_ON_NSCHFDOPPOK_11
|				ИЛИ ЭКОМ_ЦепочкиДокументовПоставщика.Статус_ON_KORSCHFDOPPOK_11)
|				И ЭКОМ_ЦепочкиДокументовПоставщика.Статус_DP_PDPOL_02
|				И ЭКОМ_ЦепочкиДокументовПоставщика.Статус_DP_IZVPOL_04
|				И ЭКОМ_ЦепочкиДокументовПоставщика.Статус_DP_IZVPOL_06
|			ТОГДА ""Документооборот завершен""
|		КОГДА ЭКОМ_ЦепочкиДокументовПоставщика.Статус_DP_UVUTOCH_09
|			ТОГДА ""Пришло уточнение от покупателя. Необходимо внести исправления.""
|		КОГДА ЭКОМ_ЦепочкиДокументовПоставщика.Статус_ON_NSCHFDOPPR_01
|				ИЛИ ЭКОМ_ЦепочкиДокументовПоставщика.Статус_ON_NSCHFDOPPR_01_Испр
|				ИЛИ ЭКОМ_ЦепочкиДокументовПоставщика.Статус_ON_KORSCHFDOPPR_01
|				ИЛИ ЭКОМ_ЦепочкиДокументовПоставщика.Статус_ON_KORSCHFDOPPR_01_Испр
|			ТОГДА ""Ожидайте квитанции ЮЗД""
|		КОГДА ЭКОМ_ЦепочкиДокументовПоставщика.Статус_RECADV
|				И НЕ(ЭКОМ_ЦепочкиДокументовПоставщика.СЧФ ЕСТЬ NULL
|						ИЛИ ЭКОМ_ЦепочкиДокументовПоставщика.СЧФ = НЕОПРЕДЕЛЕНО)
|				И ЭКОМ_ЦепочкиДокументовПоставщика.Накладная_Кор.ВидОперации = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийИсправленияПоступленияРеализации.СогласованноеИзменение)
|			ТОГДА ""Отправьте УКД""
|		КОГДА ЭКОМ_ЦепочкиДокументовПоставщика.Статус_RECADV
|				И НЕ(ЭКОМ_ЦепочкиДокументовПоставщика.СЧФ ЕСТЬ NULL
|						ИЛИ ЭКОМ_ЦепочкиДокументовПоставщика.СЧФ = НЕОПРЕДЕЛЕНО)
|			ТОГДА ""Отправьте УПД""
|		КОГДА ЭКОМ_ЦепочкиДокументовПоставщика.Статус_RECADV
|				И (ЭКОМ_ЦепочкиДокументовПоставщика.СЧФ ЕСТЬ NULL
|					ИЛИ ЭКОМ_ЦепочкиДокументовПоставщика.СЧФ = НЕОПРЕДЕЛЕНО)
|			ТОГДА ""Создайте Счет-фактуру""
|		КОГДА ЭКОМ_ЦепочкиДокументовПоставщика.Статус_DESADV
|				И НЕ ЭКОМ_ЦепочкиДокументовПоставщика.Статус_RECADV
|			ТОГДА ""Ожидайте RECADV""
|		КОГДА НЕ ЭКОМ_ЦепочкиДокументовПоставщика.Накладная ЕСТЬ NULL
|				И ЭКОМ_ЦепочкиДокументовПоставщика.Статус_ORDRSP
|				И НЕ ЭКОМ_ЦепочкиДокументовПоставщика.Статус_DESADV
|			ТОГДА ""Отправьте DESADV""
|		КОГДА ЭКОМ_ЦепочкиДокументовПоставщика.Статус_ORDRSP
|				И ЭКОМ_ЦепочкиДокументовПоставщика.Накладная ЕСТЬ NULL
|			ТОГДА ""Создайте Реализацию товаров и услуг""
|		КОГДА НЕ ЭКОМ_ЦепочкиДокументовПоставщика.Заказ ЕСТЬ NULL
|				И НЕ ЭКОМ_ЦепочкиДокументовПоставщика.Статус_ORDRSP
|			ТОГДА ""Отправьте ORDRSP""
|		КОГДА ЭКОМ_ЦепочкиДокументовПоставщика.Статус_ORDER
|				И ЭКОМ_ЦепочкиДокументовПоставщика.Заказ ЕСТЬ NULL
|			ТОГДА ""Создайте Заказ покупателя""
|		ИНАЧЕ ""-""
|	КОНЕЦ КАК Статус,
|	ЗНАЧЕНИЕ(Перечисление.ЭКОМ_ВидыДокументов.ПустаяСсылка) КАК ВидДокумента,
|	ВЫБОР
|		КОГДА НЕ ЭКОМ_ЦепочкиДокументовПоставщика.ТекстОшибки = """"
|			ТОГДА ИСТИНА
|		ИНАЧЕ ЛОЖЬ
|	КОНЕЦ КАК ЕстьОшибка,
|	ВЫБОР
|		КОГДА ЕСТЬNULL(ЭКОМ_ЦепочкиДокументовПоставщика.КоличествоНакладная, 0) <> ЕСТЬNULL(ЭКОМ_ЦепочкиДокументовПоставщика.КоличествоRECADV, 0)
|				И ЭКОМ_ЦепочкиДокументовПоставщика.Статус_RECADV
|			ТОГДА ИСТИНА
|		ИНАЧЕ ЛОЖЬ
|	КОНЕЦ КАК ЕстьРасхождение,
|	ЭКОМ_ЦепочкиДокументовПоставщика.Статус_Транспорт КАК Транспорт
|ИЗ
|	РегистрСведений.ЭКОМ_ЦепочкиДокументовПоставщика КАК ЭКОМ_ЦепочкиДокументовПоставщика
|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЭКОМ_GLN КАК ЭКОМ_GLN_Контрагент
|		ПО ЭКОМ_ЦепочкиДокументовПоставщика.Контрагент = ЭКОМ_GLN_Контрагент.Объект
|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЭКОМ_Объекты_События КАК Уточнение
|		ПО ЭКОМ_ЦепочкиДокументовПоставщика.СЧФ = Уточнение.Документ_Основание
|			И (Уточнение.ВидДокумента = ЗНАЧЕНИЕ(Перечисление.ЭКОМ_ВидыДокументов.DP_UVUTOCH_09))
|ГДЕ
|	ЭКОМ_ЦепочкиДокументовПоставщика.ORDERDATE МЕЖДУ &ДатаНач И &ДатаКон";
