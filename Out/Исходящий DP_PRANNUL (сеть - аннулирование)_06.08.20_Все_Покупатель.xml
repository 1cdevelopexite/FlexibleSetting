<ValueTree xmlns="http://v8.1c.ru/8.1/data/core" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="ValueTree">
	<column>
		<Name xsi:type="xs:string">Использовать</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">ТипТранзакции</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">Источник</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">Приемник</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">Служебные</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">Атрибуты</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">Данные</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">ДанныеЗначения</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">ДоступныеЗначения</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">Связи</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">Сохранение</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">Загрузка</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">Обязательный</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">Кнопка</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">КоллекцияТЧ</Name>
		<ValueType/>
	</column>
	<row>
		<row>
			<row>
				<row>
					<Value xsi:type="xs:boolean">true</Value>
					<Value xsi:type="xs:string"/>
					<Value xsi:type="xs:string"/>
					<Value xsi:type="xs:string">ЮЛ</Value>
					<Value xsi:type="xs:string"/>
					<Value xsi:type="ValueListType">
						<valueType/>
						<lastId xsi:type="xs:decimal">5</lastId>
						<item>
							<value xsi:type="xs:string">НаимОрг</value>
							<presentation>Документ.УчастЭДО_НаимОрг</presentation>
							<checkState>1</checkState>
							<id xsi:type="xs:decimal">3</id>
						</item>
						<item>
							<value xsi:type="xs:string">ИННЮЛ</value>
							<presentation>Документ.УчастЭДО_ИННЮЛ</presentation>
							<checkState>1</checkState>
							<id xsi:type="xs:decimal">4</id>
						</item>
						<item>
							<value xsi:type="xs:string">КПП</value>
							<presentation>Документ.УчастЭДО_КПП</presentation>
							<checkState>1</checkState>
							<id xsi:type="xs:decimal">5</id>
						</item>
					</Value>
					<Value xsi:type="xs:string"/>
					<Value xsi:type="ValueTable"/>
					<Value xsi:type="ValueListType">
						<valueType/>
						<lastId xsi:type="xs:decimal">-1</lastId>
					</Value>
					<Value xsi:type="ValueListType">
						<valueType/>
						<lastId xsi:type="xs:decimal">-1</lastId>
					</Value>
					<Value xsi:type="xs:decimal">0</Value>
					<Value xsi:type="xs:decimal">0</Value>
					<Value xsi:type="xs:boolean">true</Value>
					<Value xsi:type="xs:string"/>
					<Value xsi:type="ValueListType">
						<valueType/>
						<lastId xsi:type="xs:decimal">-1</lastId>
					</Value>
				</row>
				<Value xsi:type="xs:boolean">true</Value>
				<Value xsi:type="xs:string"/>
				<Value xsi:type="xs:string"/>
				<Value xsi:type="xs:string">УчастЭДО</Value>
				<Value xsi:nil="true"/>
				<Value xsi:type="ValueListType">
					<valueType/>
					<lastId xsi:type="xs:decimal">1</lastId>
					<item>
						<value xsi:type="xs:string">ИдУчастЭДО</value>
						<presentation>Документ.УчастЭДО_ИдУчастЭДО</presentation>
						<checkState>1</checkState>
						<id xsi:type="xs:decimal">1</id>
					</item>
				</Value>
				<Value xsi:type="xs:string"/>
				<Value xsi:type="ValueTable"/>
				<Value xsi:type="ValueListType">
					<valueType/>
					<lastId xsi:type="xs:decimal">-1</lastId>
				</Value>
				<Value xsi:type="ValueListType">
					<valueType/>
					<lastId xsi:type="xs:decimal">-1</lastId>
				</Value>
				<Value xsi:type="xs:decimal">0</Value>
				<Value xsi:type="xs:decimal">0</Value>
				<Value xsi:type="xs:boolean">true</Value>
				<Value xsi:type="xs:string"/>
				<Value xsi:type="ValueListType">
					<valueType/>
					<lastId xsi:type="xs:decimal">-1</lastId>
				</Value>
			</row>
			<row>
				<row>
					<row>
						<Value xsi:type="xs:boolean">true</Value>
						<Value xsi:type="xs:string"/>
						<Value xsi:type="xs:string"/>
						<Value xsi:type="xs:string">ЭЦПАнФайл</Value>
						<Value xsi:nil="true"/>
						<Value xsi:type="ValueListType">
							<valueType/>
							<lastId xsi:type="xs:decimal">-1</lastId>
						</Value>
						<Value xsi:type="xs:string">Документ.ЭЦПАнФайл</Value>
						<Value xsi:type="ValueTable"/>
						<Value xsi:type="ValueListType">
							<valueType/>
							<lastId xsi:type="xs:decimal">-1</lastId>
						</Value>
						<Value xsi:type="ValueListType">
							<valueType/>
							<lastId xsi:type="xs:decimal">-1</lastId>
						</Value>
						<Value xsi:type="xs:decimal">0</Value>
						<Value xsi:type="xs:decimal">0</Value>
						<Value xsi:type="xs:boolean">false</Value>
						<Value xsi:type="xs:string"/>
						<Value xsi:type="ValueListType">
							<valueType/>
							<lastId xsi:type="xs:decimal">-1</lastId>
						</Value>
					</row>
					<Value xsi:type="xs:boolean">true</Value>
					<Value xsi:type="xs:string"/>
					<Value xsi:type="xs:string"/>
					<Value xsi:type="xs:string">СведАнФайл</Value>
					<Value xsi:nil="true"/>
					<Value xsi:type="ValueListType">
						<valueType/>
						<lastId xsi:type="xs:decimal">1</lastId>
						<item>
							<value xsi:type="xs:string">ИмяАнФайла</value>
							<presentation>Документ.ИмяАнФайла</presentation>
							<checkState>1</checkState>
							<id xsi:type="xs:decimal">1</id>
						</item>
					</Value>
					<Value xsi:type="xs:string"/>
					<Value xsi:type="ValueTable"/>
					<Value xsi:type="ValueListType">
						<valueType/>
						<lastId xsi:type="xs:decimal">-1</lastId>
					</Value>
					<Value xsi:type="ValueListType">
						<valueType/>
						<lastId xsi:type="xs:decimal">-1</lastId>
					</Value>
					<Value xsi:type="xs:decimal">0</Value>
					<Value xsi:type="xs:decimal">0</Value>
					<Value xsi:type="xs:boolean">true</Value>
					<Value xsi:type="xs:string"/>
					<Value xsi:type="ValueListType">
						<valueType/>
						<lastId xsi:type="xs:decimal">-1</lastId>
					</Value>
				</row>
				<row>
					<Value xsi:type="xs:boolean">true</Value>
					<Value xsi:type="xs:string"/>
					<Value xsi:type="xs:string"/>
					<Value xsi:type="xs:string">ТекстПредАн</Value>
					<Value xsi:nil="true"/>
					<Value xsi:type="ValueListType">
						<valueType/>
						<lastId xsi:type="xs:decimal">-1</lastId>
					</Value>
					<Value xsi:type="xs:string">Документ.ТекстПредАн</Value>
					<Value xsi:type="ValueTable"/>
					<Value xsi:type="ValueListType">
						<valueType/>
						<lastId xsi:type="xs:decimal">-1</lastId>
					</Value>
					<Value xsi:type="ValueListType">
						<valueType/>
						<lastId xsi:type="xs:decimal">-1</lastId>
					</Value>
					<Value xsi:type="xs:decimal">0</Value>
					<Value xsi:type="xs:decimal">0</Value>
					<Value xsi:type="xs:boolean">true</Value>
					<Value xsi:type="xs:string"/>
					<Value xsi:type="ValueListType">
						<valueType/>
						<lastId xsi:type="xs:decimal">-1</lastId>
					</Value>
				</row>
				<Value xsi:type="xs:boolean">true</Value>
				<Value xsi:type="xs:string"/>
				<Value xsi:type="xs:string"/>
				<Value xsi:type="xs:string">СвПредАн</Value>
				<Value xsi:nil="true"/>
				<Value xsi:type="ValueListType">
					<valueType/>
					<lastId xsi:type="xs:decimal">-1</lastId>
				</Value>
				<Value xsi:type="xs:string"/>
				<Value xsi:type="ValueTable"/>
				<Value xsi:type="ValueListType">
					<valueType/>
					<lastId xsi:type="xs:decimal">-1</lastId>
				</Value>
				<Value xsi:type="ValueListType">
					<valueType/>
					<lastId xsi:type="xs:decimal">-1</lastId>
				</Value>
				<Value xsi:type="xs:decimal">0</Value>
				<Value xsi:type="xs:decimal">0</Value>
				<Value xsi:type="xs:boolean">true</Value>
				<Value xsi:type="xs:string"/>
				<Value xsi:type="ValueListType">
					<valueType/>
					<lastId xsi:type="xs:decimal">-1</lastId>
				</Value>
			</row>
			<row>
				<row>
					<Value xsi:type="xs:boolean">true</Value>
					<Value xsi:type="xs:string"/>
					<Value xsi:type="xs:string"/>
					<Value xsi:type="xs:string">ЮЛ</Value>
					<Value xsi:type="xs:string">ИспользоватьСтрокуДерева = Ложь;
Если  Документ.ТипПолучателя = "ЮЛ" Тогда
	ИспользоватьСтрокуДерева = Истина;
КонецЕсли;
	
Возврат ИспользоватьСтрокуДерева;</Value>
					<Value xsi:type="ValueListType">
						<valueType/>
						<lastId xsi:type="xs:decimal">11</lastId>
						<item>
							<value xsi:type="xs:string">НаимОрг</value>
							<presentation>Документ.НапрПредАн_НаимОрг</presentation>
							<checkState>1</checkState>
							<id xsi:type="xs:decimal">9</id>
						</item>
						<item>
							<value xsi:type="xs:string">ИННЮЛ</value>
							<presentation>Документ.НапрПредАн_ИННЮЛ</presentation>
							<checkState>1</checkState>
							<id xsi:type="xs:decimal">10</id>
						</item>
						<item>
							<value xsi:type="xs:string">КПП</value>
							<presentation>Документ.НапрПредАн_КПП</presentation>
							<checkState>1</checkState>
							<id xsi:type="xs:decimal">11</id>
						</item>
					</Value>
					<Value xsi:type="xs:string"/>
					<Value xsi:type="ValueTable"/>
					<Value xsi:type="ValueListType">
						<valueType/>
						<lastId xsi:type="xs:decimal">-1</lastId>
					</Value>
					<Value xsi:type="ValueListType">
						<valueType/>
						<lastId xsi:type="xs:decimal">-1</lastId>
					</Value>
					<Value xsi:type="xs:decimal">0</Value>
					<Value xsi:type="xs:decimal">0</Value>
					<Value xsi:type="xs:boolean">false</Value>
					<Value xsi:type="xs:string"/>
					<Value xsi:type="ValueListType">
						<valueType/>
						<lastId xsi:type="xs:decimal">-1</lastId>
					</Value>
				</row>
				<row>
					<row>
						<Value xsi:type="xs:boolean">true</Value>
						<Value xsi:type="xs:string"/>
						<Value xsi:type="xs:string"/>
						<Value xsi:type="xs:string">ФИО</Value>
						<Value xsi:nil="true"/>
						<Value xsi:type="ValueListType">
							<valueType/>
							<lastId xsi:type="xs:decimal">11</lastId>
							<item>
								<value xsi:type="xs:string">Фамилия</value>
								<presentation>Документ.НапрПредАн_ФамилияФЛ</presentation>
								<id xsi:type="xs:decimal">9</id>
							</item>
							<item>
								<value xsi:type="xs:string">Имя</value>
								<presentation>Документ.НапрПредАн_ИмяФЛ</presentation>
								<id xsi:type="xs:decimal">10</id>
							</item>
							<item>
								<value xsi:type="xs:string">Отчество</value>
								<presentation>Документ.НапрПредАн_ОтчествоФЛ</presentation>
								<id xsi:type="xs:decimal">11</id>
							</item>
						</Value>
						<Value xsi:type="xs:string"/>
						<Value xsi:type="ValueTable"/>
						<Value xsi:type="ValueListType">
							<valueType/>
							<lastId xsi:type="xs:decimal">-1</lastId>
						</Value>
						<Value xsi:type="ValueListType">
							<valueType/>
							<lastId xsi:type="xs:decimal">-1</lastId>
						</Value>
						<Value xsi:type="xs:decimal">0</Value>
						<Value xsi:type="xs:decimal">0</Value>
						<Value xsi:type="xs:boolean">false</Value>
						<Value xsi:type="xs:string"/>
						<Value xsi:type="ValueListType">
							<valueType/>
							<lastId xsi:type="xs:decimal">-1</lastId>
						</Value>
					</row>
					<Value xsi:type="xs:boolean">true</Value>
					<Value xsi:type="xs:string"/>
					<Value xsi:type="xs:string"/>
					<Value xsi:type="xs:string">ИП</Value>
					<Value xsi:type="xs:string">ИспользоватьСтрокуДерева = Ложь;
Если  Документ.ТипПолучателя = "ИП" Тогда
	ИспользоватьСтрокуДерева = Истина;
КонецЕсли;
	
Возврат ИспользоватьСтрокуДерева;</Value>
					<Value xsi:type="ValueListType">
						<valueType/>
						<lastId xsi:type="xs:decimal">2</lastId>
						<item>
							<value xsi:type="xs:string">ИННФЛ</value>
							<presentation>Документ.НапрПредАн_ИННЮЛ</presentation>
							<checkState>1</checkState>
							<id xsi:type="xs:decimal">2</id>
						</item>
					</Value>
					<Value xsi:type="xs:string"/>
					<Value xsi:type="ValueTable"/>
					<Value xsi:type="ValueListType">
						<valueType/>
						<lastId xsi:type="xs:decimal">-1</lastId>
					</Value>
					<Value xsi:type="ValueListType">
						<valueType/>
						<lastId xsi:type="xs:decimal">-1</lastId>
					</Value>
					<Value xsi:type="xs:decimal">0</Value>
					<Value xsi:type="xs:decimal">0</Value>
					<Value xsi:type="xs:boolean">false</Value>
					<Value xsi:type="xs:string"/>
					<Value xsi:type="ValueListType">
						<valueType/>
						<lastId xsi:type="xs:decimal">-1</lastId>
					</Value>
				</row>
				<Value xsi:type="xs:boolean">true</Value>
				<Value xsi:type="xs:string"/>
				<Value xsi:type="xs:string"/>
				<Value xsi:type="xs:string">НапрПредАн</Value>
				<Value xsi:nil="true"/>
				<Value xsi:type="ValueListType">
					<valueType/>
					<lastId xsi:type="xs:decimal">1</lastId>
					<item>
						<value xsi:type="xs:string">ИдУчастЭДО</value>
						<presentation>Документ.НапрПредАн_ИдУчастЭДО</presentation>
						<checkState>1</checkState>
						<id xsi:type="xs:decimal">1</id>
					</item>
				</Value>
				<Value xsi:type="xs:string"/>
				<Value xsi:type="ValueTable"/>
				<Value xsi:type="ValueListType">
					<valueType/>
					<lastId xsi:type="xs:decimal">-1</lastId>
				</Value>
				<Value xsi:type="ValueListType">
					<valueType/>
					<lastId xsi:type="xs:decimal">-1</lastId>
				</Value>
				<Value xsi:type="xs:decimal">0</Value>
				<Value xsi:type="xs:decimal">0</Value>
				<Value xsi:type="xs:boolean">false</Value>
				<Value xsi:type="xs:string"/>
				<Value xsi:type="ValueListType">
					<valueType/>
					<lastId xsi:type="xs:decimal">-1</lastId>
				</Value>
			</row>
			<row>
				<row>
					<Value xsi:type="xs:boolean">true</Value>
					<Value xsi:type="xs:string"/>
					<Value xsi:type="xs:string"/>
					<Value xsi:type="xs:string">ФИО</Value>
					<Value xsi:nil="true"/>
					<Value xsi:type="ValueListType">
						<valueType/>
						<lastId xsi:type="xs:decimal">4</lastId>
						<item>
							<value xsi:type="xs:string">Имя</value>
							<presentation>Документ.Подписант_Имя</presentation>
							<checkState>1</checkState>
							<id xsi:type="xs:decimal">2</id>
						</item>
						<item>
							<value xsi:type="xs:string">Фамилия</value>
							<presentation>Документ.Подписант_Фамилия</presentation>
							<checkState>1</checkState>
							<id xsi:type="xs:decimal">3</id>
						</item>
						<item>
							<value xsi:type="xs:string">Отчество</value>
							<presentation>Документ.Подписант_Отчество</presentation>
							<id xsi:type="xs:decimal">4</id>
						</item>
					</Value>
					<Value xsi:type="xs:string"/>
					<Value xsi:type="ValueTable"/>
					<Value xsi:type="ValueListType">
						<valueType/>
						<lastId xsi:type="xs:decimal">-1</lastId>
					</Value>
					<Value xsi:type="ValueListType">
						<valueType/>
						<lastId xsi:type="xs:decimal">-1</lastId>
					</Value>
					<Value xsi:type="xs:decimal">0</Value>
					<Value xsi:type="xs:decimal">0</Value>
					<Value xsi:type="xs:boolean">true</Value>
					<Value xsi:type="xs:string"/>
					<Value xsi:type="ValueListType">
						<valueType/>
						<lastId xsi:type="xs:decimal">-1</lastId>
					</Value>
				</row>
				<Value xsi:type="xs:boolean">true</Value>
				<Value xsi:type="xs:string"/>
				<Value xsi:type="xs:string"/>
				<Value xsi:type="xs:string">Подписант</Value>
				<Value xsi:nil="true"/>
				<Value xsi:type="ValueListType">
					<valueType/>
					<lastId xsi:type="xs:decimal">1</lastId>
					<item>
						<value xsi:type="xs:string">Должность</value>
						<presentation>Документ.Подписант_Должность</presentation>
						<checkState>1</checkState>
						<id xsi:type="xs:decimal">1</id>
					</item>
				</Value>
				<Value xsi:type="xs:string"/>
				<Value xsi:type="ValueTable"/>
				<Value xsi:type="ValueListType">
					<valueType/>
					<lastId xsi:type="xs:decimal">-1</lastId>
				</Value>
				<Value xsi:type="ValueListType">
					<valueType/>
					<lastId xsi:type="xs:decimal">-1</lastId>
				</Value>
				<Value xsi:type="xs:decimal">0</Value>
				<Value xsi:type="xs:decimal">0</Value>
				<Value xsi:type="xs:boolean">true</Value>
				<Value xsi:type="xs:string"/>
				<Value xsi:type="ValueListType">
					<valueType/>
					<lastId xsi:type="xs:decimal">-1</lastId>
				</Value>
			</row>
			<Value xsi:type="xs:boolean">true</Value>
			<Value xsi:type="xs:string"/>
			<Value xsi:type="xs:string"/>
			<Value xsi:type="xs:string">Документ</Value>
			<Value xsi:nil="true"/>
			<Value xsi:type="ValueListType">
				<valueType/>
				<lastId xsi:type="xs:decimal">-1</lastId>
			</Value>
			<Value xsi:type="xs:string"/>
			<Value xsi:type="ValueTable"/>
			<Value xsi:type="ValueListType">
				<valueType/>
				<lastId xsi:type="xs:decimal">-1</lastId>
			</Value>
			<Value xsi:type="ValueListType">
				<valueType/>
				<lastId xsi:type="xs:decimal">-1</lastId>
			</Value>
			<Value xsi:type="xs:decimal">0</Value>
			<Value xsi:type="xs:decimal">0</Value>
			<Value xsi:type="xs:boolean">true</Value>
			<Value xsi:type="xs:string"/>
			<Value xsi:type="ValueListType">
				<valueType/>
				<lastId xsi:type="xs:decimal">-1</lastId>
			</Value>
		</row>
		<Value xsi:type="xs:boolean">true</Value>
		<Value xsi:type="xs:string">Исходящий DP_PRANNUL (покупатель - аннулирование)</Value>
		<Value xsi:type="xs:string">ДокументЭКОМ_ЮЗД</Value>
		<Value xsi:type="xs:string">Файл</Value>
		<Value xsi:type="Structure">
			<Property name="ВидДокумента">
				<Value xsi:type="xs:string">Документ.ВидДокумента</Value>
			</Property>
			<Property name="ЗаказДата">
				<Value xsi:type="xs:string">Документ.ЗаказДата</Value>
			</Property>
			<Property name="ЗаказНомер">
				<Value xsi:type="xs:string">Документ.ЗаказНомер</Value>
			</Property>
			<Property name="Идентификатор">
				<Value xsi:type="xs:string">Документ.Идентификатор</Value>
			</Property>
			<Property name="ИдентификаторИспр">
				<Value xsi:type="xs:string">Документ.ИдентификаторИспр</Value>
			</Property>
			<Property name="Контрагент">
				<Value xsi:type="xs:string">Документ.Контрагент</Value>
			</Property>
			<Property name="Номер">
				<Value xsi:type="xs:string"/>
			</Property>
			<Property name="Организация">
				<Value xsi:type="xs:string">Документ.Организация</Value>
			</Property>
			<Property name="Ссылка">
				<Value xsi:type="xs:string">Документ.Ссылка</Value>
			</Property>
			<Property name="Статус">
				<Value xsi:type="xs:string">Документ.Статус</Value>
			</Property>
			<Property name="ФайлИмя">
				<Value xsi:type="xs:string">Документ.ФайлИмя</Value>
			</Property>
			<Property name="ЭлектронныйДокумент">
				<Value xsi:nil="true"/>
			</Property>
		</Value>
		<Value xsi:type="ValueListType">
			<valueType/>
			<lastId xsi:type="xs:decimal">5</lastId>
			<item>
				<value xsi:type="xs:string">ВерсПрог</value>
				<presentation>Документ.ВерсПрог</presentation>
				<checkState>1</checkState>
				<id xsi:type="xs:decimal">3</id>
			</item>
			<item>
				<value xsi:type="xs:string">ВерсФорм</value>
				<presentation>Документ.ВерсФорм</presentation>
				<checkState>1</checkState>
				<id xsi:type="xs:decimal">4</id>
			</item>
			<item>
				<value xsi:type="xs:string">ИдФайл</value>
				<presentation>Документ.ИдФайл</presentation>
				<checkState>1</checkState>
				<id xsi:type="xs:decimal">5</id>
			</item>
		</Value>
		<Value xsi:type="xs:string">Запрос = Новый Запрос;
Запрос.Текст = "ВЫБРАТЬ
               |	ЭКОМ_ДокументыЮЗД.Ссылка КАК Ссылка,
               |	ЗНАЧЕНИЕ(Перечисление.ЭКОМ_ВидыДокументов.DP_PRANNUL_12) КАК ВидДокумента,
               |	ЭКОМ_ДокументыЮЗД.ЗаказДата КАК ЗаказДата,
               |	ЭКОМ_ДокументыЮЗД.ЗаказНомер КАК ЗаказНомер,
               |	ЭКОМ_ДокументыЮЗД.НомерТранзакции КАК ИдентификаторОснование,
               |	ЭКОМ_ДокументыЮЗД.Контрагент КАК Контрагент,
               |	ЭКОМ_ДокументыЮЗД.Организация КАК Организация,
               |	ЗНАЧЕНИЕ(Перечисление.ЭКОМ_Статусы.Отправлен) КАК Статус,
               |	ЭКОМ_ДокументыЮЗД.xmlКонтрагент КАК xmlКонтрагент,
               |	ЭКОМ_ДокументыЮЗД.xmlОрганизация КАК xmlОрганизация,
               |	ЭКОМ_ДокументыЮЗД.Контрагент.ИНН КАК КонтрагентИНН,
               |	ЭКОМ_ДокументыЮЗД.Контрагент.КПП КАК КонтрагентКПП,
               |	ЭКОМ_ДокументыЮЗД.Контрагент.Наименование КАК КонтрагентНаименование,
               |	ЭКОМ_ДокументыЮЗД.Организация.ИНН КАК ОрганизацияИНН,
               |	ЭКОМ_ДокументыЮЗД.Организация.КПП КАК ОрганизацияКПП,
               |	ЭКОМ_ДокументыЮЗД.Организация.Наименование КАК ОрганизацияНаименование,
               |	ЭКОМ_GLN.Сертификат.ДолжностьПодписанта КАК СертификатДолжностьПодписанта,
               |	ЭКОМ_GLN.Сертификат.ФамилияПодписанта КАК СертификатФамилияПодписанта,
               |	ЭКОМ_GLN.Сертификат.ИмяПодписанта КАК СертификатИмяПодписанта,
               |	ЭКОМ_GLN.Сертификат.ОтчествоПодписанта КАК СертификатОтчествоПодписанта,
               |	ЭКОМ_ДокументыЮЗД.НомерТранзакции КАК ИмяПоступившегоФайла,
               |	ЭКОМ_Объекты_События.ЭЦП КАК ЭЦП_ПоступившегоФайла,
               |	ЭКОМ_Объекты_События.СтруктураФайла КАК СтруктураФайлаЮЗД,
               |	ЭКОМ_ЦепочкиДокументовПокупателя.ТекстПричиныАннулирования КАК Комментарий
               |ИЗ
               |	Документ.ЭКОМ_Документы КАК ЭКОМ_ДокументыЮЗД
               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЭКОМ_GLN КАК ЭКОМ_GLN
               |		ПО (ЭКОМ_ДокументыЮЗД.Организация = ЭКОМ_GLN.Объект)
               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЭКОМ_Объекты_События КАК ЭКОМ_Объекты_События
               |		ПО (ЭКОМ_ДокументыЮЗД.Ссылка = ЭКОМ_Объекты_События.Документ_Основание)
               |			И (ЭКОМ_ДокументыЮЗД.ВидДокумента = ЭКОМ_Объекты_События.ВидДокумента)
               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЭКОМ_ЦепочкиДокументовПокупателя КАК ЭКОМ_ЦепочкиДокументовПокупателя
               |		ПО (ЭКОМ_ДокументыЮЗД.Ссылка = ЭКОМ_ЦепочкиДокументовПокупателя.ЮЗД)
               |ГДЕ
               |	ЭКОМ_ДокументыЮЗД.Ссылка В (&amp;Документ)";

Запрос.УстановитьПараметр("Документ", Источник);
РезультатЗапроса = Запрос.Выполнить();
ВыборкаДокумента = РезультатЗапроса.Выбрать();

Результат = Новый ТаблицаЗначений;
МассивКолонок = Новый Массив;

//Сведения для регистра ЭКОМ события для документа
МассивКолонок.Добавить("ВидДокумента");
МассивКолонок.Добавить("ЗаказДата");
МассивКолонок.Добавить("ЗаказНомер");
МассивКолонок.Добавить("Идентификатор");
МассивКолонок.Добавить("ИдентификаторИспр");
МассивКолонок.Добавить("Контрагент");
МассивКолонок.Добавить("Организация");
МассивКолонок.Добавить("Ссылка");
МассивКолонок.Добавить("Статус");
МассивКолонок.Добавить("ФайлИмя");

//Файл
МассивКолонок.Добавить("ИдФайл");
МассивКолонок.Добавить("ВерсПрог");
МассивКолонок.Добавить("ВерсФорм");

//УчастЭДО
МассивКолонок.Добавить("УчастЭДО_ИдУчастЭДО");
МассивКолонок.Добавить("УчастЭДО_НаимОрг");
МассивКолонок.Добавить("УчастЭДО_ИННЮЛ");
МассивКолонок.Добавить("УчастЭДО_КПП");

//СведАнФайл
МассивКолонок.Добавить("ИмяАнФайла");
МассивКолонок.Добавить("ЭЦПАнФайл");

//ТекстПредАн
МассивКолонок.Добавить("ТекстПредАн");

//НапрПредАн
МассивКолонок.Добавить("ТипПолучателя");
МассивКолонок.Добавить("НапрПредАн_ИдУчастЭДО");
МассивКолонок.Добавить("НапрПредАн_НаимОрг");
МассивКолонок.Добавить("НапрПредАн_ИННЮЛ");
МассивКолонок.Добавить("НапрПредАн_КПП");
МассивКолонок.Добавить("НапрПредАн_ФамилияФЛ");
МассивКолонок.Добавить("НапрПредАн_ИмяФЛ");
МассивКолонок.Добавить("НапрПредАн_ОтчествоФЛ");

//Подписант
МассивКолонок.Добавить("Подписант_Должность");
МассивКолонок.Добавить("Подписант_Фамилия");
МассивКолонок.Добавить("Подписант_Имя");
МассивКолонок.Добавить("Подписант_Отчество");

Для Каждого Колонка Из МассивКолонок Цикл
	Результат.Колонки.Добавить(Колонка);
КонецЦикла;

СтруктураМетаДанных  = ЮрФизЛицоОпределитьМетаданные();

Пока ВыборкаДокумента.Следующий() Цикл
	
	НапрПредАн_ИдУчастЭДО = ВыборкаДокумента.xmlКонтрагент; 
	УчастЭДО_ИдУчастЭДО   = ВыборкаДокумента.xmlОрганизация;

	СтруктураФайлаЮЗД = Неопределено;
	Если ЗначениеЗаполнено(ВыборкаДокумента.СтруктураФайлаЮЗД) Тогда	
		СтруктураФайлаЮЗД = ВыборкаДокумента.СтруктураФайлаЮЗД.Получить();
	КонецЕсли;

	// Получаю из хранилища двоичные данные подписи
	ЭЦПАнФайл = Неопределено;
	Если ЗначениеЗаполнено(ВыборкаДокумента.ЭЦП_ПоступившегоФайла) Тогда	
		ЭЦПАнФайл = ВыборкаДокумента.ЭЦП_ПоступившегоФайла.Получить();
		
		Если НЕ ЗначениеЗаполнено(ЭЦПАнФайл) Тогда
			Сообщить("ЭЦП не определен! на документ " + ВыборкаДокумента.ИмяПоступившегоФайла  + " аннулирование отправлено не будет!");
			Продолжить;			
		КонецЕсли;	
		
	Иначе
		Сообщить("Нет данных по ЭЦП для документа - " + ВыборкаДокумента.ИмяПоступившегоФайла  + " аннулирование отправлено не будет!");
		Продолжить;
	КонецЕсли;
	
	СтруктураДокумента = Результат.Добавить();	
	СтруктураДокумента.НапрПредАн_ИдУчастЭДО = НапрПредАн_ИдУчастЭДО;
	СтруктураДокумента.НапрПредАн_ИННЮЛ      = ВыборкаДокумента.КонтрагентИНН;
	
	ЭтоЮрЛицоКонтрагент  = ЮрФизЛицоОпределитьТипОбъекта(ВыборкаДокумента.Контрагент, СтруктураМетаДанных.ИмяРеквизитаКонтрагента, СтруктураМетаДанных.ПеречислениеЮрЛицо); 
	Если ЭтоЮрЛицоКонтрагент Тогда
		
		//НапрПредАн
		СтруктураДокумента.ТипПолучателя = "ЮЛ";		
		СтруктураДокумента.НапрПредАн_НаимОрг = ВыборкаДокумента.КонтрагентНаименование;		
		СтруктураДокумента.НапрПредАн_КПП     = ВыборкаДокумента.КонтрагентКПП;
		
	Иначе
		
		//НапрПредАн
		СтруктураДокумента.ТипПолучателя = "ИП";		
		СтруктураДокумента.НапрПредАн_ФамилияФЛ  = "Нет";
		СтруктураДокумента.НапрПредАн_ИмяФЛ      = "Нет";
		СтруктураДокумента.НапрПредАн_ОтчествоФЛ = "";
		
		Если НЕ СтруктураФайлаЮЗД = Неопределено Тогда
			
			Если СтруктураФайлаЮЗД.Свойство("Документ_Подписант_ФЛ_ФИО_Фамилия") Тогда
				СтруктураДокумента.НапрПредАн_ФамилияФЛ  = СтруктураФайлаЮЗД.Документ_Подписант_ФЛ_ФИО_Фамилия;
			ИначеЕсли СтруктураФайлаЮЗД.Свойство("Подписант_Фамилия") Тогда
				СтруктураДокумента.НапрПредАн_ФамилияФЛ  = СтруктураФайлаЮЗД.Подписант_Фамилия;
			КонецЕсли;			
			
			Если СтруктураФайлаЮЗД.Свойство("Документ_Подписант_ФЛ_ФИО_Имя") Тогда
				СтруктураДокумента.НапрПредАн_ИмяФЛ = СтруктураФайлаЮЗД.Документ_Подписант_ФЛ_ФИО_Имя;
			ИначеЕсли СтруктураФайлаЮЗД.Свойство("Подписант_Имя") Тогда
	            СтруктураДокумента.НапрПредАн_ИмяФЛ = СтруктураФайлаЮЗД.Подписант_Имя;
			КонецЕсли;		
			
			Если СтруктураФайлаЮЗД.Свойство("Документ_Подписант_ФЛ_ФИО_Отчество") Тогда
				СтруктураДокумента.НапрПредАн_ОтчествоФЛ = СтруктураФайлаЮЗД.Документ_Подписант_ФЛ_ФИО_Отчество;
			ИначеЕсли СтруктураФайлаЮЗД.Свойство("Подписант_Отчество") Тогда
			    СтруктураДокумента.НапрПредАн_ОтчествоФЛ = СтруктураФайлаЮЗД.Подписант_Отчество;
			КонецЕсли;
						
		КонецЕсли;
		
		Если СтруктураДокумента.НапрПредАн_ФамилияФЛ = "Нет" Тогда
			НаименованиеФЛ = ВыборкаДокумента.КонтрагентНаименование;
			Если Найти(ВРег(НаименованиеФЛ), "ИП ") = 1 Тогда
				НаименованиеФЛ = Прав(НаименованиеФЛ, СтрДлина(НаименованиеФЛ) - 3);
			КонецЕсли;
			
			МассивИмяФЛ = Эком_РазложитьСтрокуВМассивПодстрок(НаименованиеФЛ, " ");
			
			Если МассивИмяФЛ.Количество() 		&gt;= 3 Тогда
				СтруктураДокумента.НапрПредАн_ФамилияФЛ 	= МассивИмяФЛ.Получить(0);
				СтруктураДокумента.НапрПредАн_ИмяФЛ 		= МассивИмяФЛ.Получить(1);
				СтруктураДокумента.НапрПредАн_ОтчествоФЛ 	= МассивИмяФЛ.Получить(2);
			ИначеЕсли МассивИмяФЛ.Количество() 	= 2 Тогда
				СтруктураДокумента.НапрПредАн_ФамилияФЛ 	= МассивИмяФЛ.Получить(0);
				СтруктураДокумента.НапрПредАн_ИмяФЛ 		= МассивИмяФЛ.Получить(1);
			ИначеЕсли МассивИмяФЛ.Количество() 	= 1 Тогда
				СтруктураДокумента.НапрПредАн_ФамилияФЛ 	= МассивИмяФЛ.Получить(0);
			КонецЕсли;
		КонецЕсли;
		
	КонецЕсли;
	
	Идентификатор = Новый УникальныйИдентификатор;
	ИдентификаторДляФайла = "DP_PRANNUL_"
	+ НапрПредАн_ИдУчастЭДО + "_"
	+ УчастЭДО_ИдУчастЭДО + "_"
	+ Формат(ТекущаяДата(), "ДФ=yyyyMMdd") + "_" 
	+ Строка(Идентификатор);
	
	//Сведения для регистра ЭКОМ события для документа
	СтруктураДокумента.ВидДокумента        = ВыборкаДокумента.ВидДокумента;
	СтруктураДокумента.ЗаказДата           = ВыборкаДокумента.ЗаказДата;
	СтруктураДокумента.ЗаказНомер          = ВыборкаДокумента.ЗаказНомер;
	СтруктураДокумента.Идентификатор       = ИдентификаторДляФайла;
	СтруктураДокумента.ИдентификаторИспр   = ВыборкаДокумента.ИдентификаторОснование;
	СтруктураДокумента.Контрагент          = ВыборкаДокумента.Контрагент;
	СтруктураДокумента.Организация         = ВыборкаДокумента.Организация;
	СтруктураДокумента.Ссылка              = ВыборкаДокумента.Ссылка;
	СтруктураДокумента.Статус              = ВыборкаДокумента.Статус;
	СтруктураДокумента.ФайлИмя             = ИдентификаторДляФайла + ".xml";
	
	//Файл
	СтруктураДокумента.ИдФайл   = ИдентификаторДляФайла;
	СтруктураДокумента.ВерсПрог = "Exite 1C";
	СтруктураДокумента.ВерсФорм = "1.02";
	
	//УчастЭДО
	СтруктураДокумента.УчастЭДО_ИдУчастЭДО = УчастЭДО_ИдУчастЭДО;
	СтруктураДокумента.УчастЭДО_НаимОрг    = ВыборкаДокумента.ОрганизацияНаименование;
	СтруктураДокумента.УчастЭДО_ИННЮЛ      = ВыборкаДокумента.ОрганизацияИНН;
	СтруктураДокумента.УчастЭДО_КПП        = ВыборкаДокумента.ОрганизацияКПП;
	
	//СведАнФайл
	СтруктураДокумента.ИмяАнФайла = ВыборкаДокумента.ИмяПоступившегоФайла;
	СтруктураДокумента.ЭЦПАнФайл  = Base64Строка(ЭЦПАнФайл);
	
	//ТекстПредАн
	СтруктураДокумента.ТекстПредАн  = ВыборкаДокумента.Комментарий;
	
	//Подписант
	СтруктураДокумента.Подписант_Должность = ВыборкаДокумента.СертификатДолжностьПодписанта;
	СтруктураДокумента.Подписант_Фамилия   = ВыборкаДокумента.СертификатФамилияПодписанта;
	СтруктураДокумента.Подписант_Имя       = ВыборкаДокумента.СертификатИмяПодписанта;
	СтруктураДокумента.Подписант_Отчество  = ВыборкаДокумента.СертификатОтчествоПодписанта;
	
КонецЦикла;

Возврат Результат;</Value>
		<Value xsi:type="ValueTable"/>
		<Value xsi:type="ValueListType">
			<valueType/>
			<lastId xsi:type="xs:decimal">32</lastId>
			<item>
				<value xsi:type="xs:string">ВидДокумента</value>
				<id xsi:type="xs:decimal">0</id>
			</item>
			<item>
				<value xsi:type="xs:string">ЗаказДата</value>
				<id xsi:type="xs:decimal">1</id>
			</item>
			<item>
				<value xsi:type="xs:string">ЗаказНомер</value>
				<id xsi:type="xs:decimal">2</id>
			</item>
			<item>
				<value xsi:type="xs:string">Идентификатор</value>
				<id xsi:type="xs:decimal">3</id>
			</item>
			<item>
				<value xsi:type="xs:string">ИдентификаторИспр</value>
				<id xsi:type="xs:decimal">4</id>
			</item>
			<item>
				<value xsi:type="xs:string">Контрагент</value>
				<id xsi:type="xs:decimal">5</id>
			</item>
			<item>
				<value xsi:type="xs:string">Организация</value>
				<id xsi:type="xs:decimal">6</id>
			</item>
			<item>
				<value xsi:type="xs:string">Ссылка</value>
				<id xsi:type="xs:decimal">7</id>
			</item>
			<item>
				<value xsi:type="xs:string">Статус</value>
				<id xsi:type="xs:decimal">8</id>
			</item>
			<item>
				<value xsi:type="xs:string">ФайлИмя</value>
				<id xsi:type="xs:decimal">9</id>
			</item>
			<item>
				<value xsi:type="xs:string">ИдФайл</value>
				<id xsi:type="xs:decimal">10</id>
			</item>
			<item>
				<value xsi:type="xs:string">ВерсПрог</value>
				<id xsi:type="xs:decimal">11</id>
			</item>
			<item>
				<value xsi:type="xs:string">ВерсФорм</value>
				<id xsi:type="xs:decimal">12</id>
			</item>
			<item>
				<value xsi:type="xs:string">УчастЭДО_ИдУчастЭДО</value>
				<id xsi:type="xs:decimal">13</id>
			</item>
			<item>
				<value xsi:type="xs:string">УчастЭДО_НаимОрг</value>
				<id xsi:type="xs:decimal">14</id>
			</item>
			<item>
				<value xsi:type="xs:string">УчастЭДО_ИННЮЛ</value>
				<id xsi:type="xs:decimal">15</id>
			</item>
			<item>
				<value xsi:type="xs:string">УчастЭДО_КПП</value>
				<id xsi:type="xs:decimal">16</id>
			</item>
			<item>
				<value xsi:type="xs:string">ИмяАнФайла</value>
				<id xsi:type="xs:decimal">17</id>
			</item>
			<item>
				<value xsi:type="xs:string">ЭЦПАнФайл</value>
				<id xsi:type="xs:decimal">18</id>
			</item>
			<item>
				<value xsi:type="xs:string">ТекстПредАн</value>
				<id xsi:type="xs:decimal">19</id>
			</item>
			<item>
				<value xsi:type="xs:string">ТипПолучателя</value>
				<id xsi:type="xs:decimal">20</id>
			</item>
			<item>
				<value xsi:type="xs:string">НапрПредАн_ИдУчастЭДО</value>
				<id xsi:type="xs:decimal">21</id>
			</item>
			<item>
				<value xsi:type="xs:string">НапрПредАн_НаимОрг</value>
				<id xsi:type="xs:decimal">22</id>
			</item>
			<item>
				<value xsi:type="xs:string">НапрПредАн_ИННЮЛ</value>
				<id xsi:type="xs:decimal">23</id>
			</item>
			<item>
				<value xsi:type="xs:string">НапрПредАн_КПП</value>
				<id xsi:type="xs:decimal">24</id>
			</item>
			<item>
				<value xsi:type="xs:string">НапрПредАн_ФамилияФЛ</value>
				<id xsi:type="xs:decimal">25</id>
			</item>
			<item>
				<value xsi:type="xs:string">НапрПредАн_ИмяФЛ</value>
				<id xsi:type="xs:decimal">26</id>
			</item>
			<item>
				<value xsi:type="xs:string">НапрПредАн_ОтчествоФЛ</value>
				<id xsi:type="xs:decimal">27</id>
			</item>
			<item>
				<value xsi:type="xs:string">Подписант_Должность</value>
				<id xsi:type="xs:decimal">28</id>
			</item>
			<item>
				<value xsi:type="xs:string">Подписант_Фамилия</value>
				<id xsi:type="xs:decimal">29</id>
			</item>
			<item>
				<value xsi:type="xs:string">Подписант_Имя</value>
				<id xsi:type="xs:decimal">30</id>
			</item>
			<item>
				<value xsi:type="xs:string">Подписант_Отчество</value>
				<id xsi:type="xs:decimal">31</id>
			</item>
			<item>
				<value xsi:type="xs:string">НомерПоПорядку</value>
				<id xsi:type="xs:decimal">32</id>
			</item>
		</Value>
		<Value xsi:type="ValueListType">
			<valueType/>
			<lastId xsi:type="xs:decimal">-1</lastId>
		</Value>
		<Value xsi:type="xs:decimal">0</Value>
		<Value xsi:type="xs:decimal">0</Value>
		<Value xsi:type="xs:boolean">true</Value>
		<Value xsi:type="xs:string">DP_PRANNUL (покупатель - аннулирование)</Value>
		<Value xsi:type="ValueListType">
			<valueType/>
			<lastId xsi:type="xs:decimal">3</lastId>
			<item>
				<value xsi:type="xs:string">ИмяКнопки</value>
				<presentation>DP_PRANNUL (покупатель - аннулирование)</presentation>
				<checkState>1</checkState>
				<id xsi:type="xs:decimal">0</id>
			</item>
			<item>
				<value xsi:type="xs:string">Покупатель</value>
				<checkState>1</checkState>
				<id xsi:type="xs:decimal">1</id>
			</item>
			<item>
				<value xsi:type="xs:string">Поставщик</value>
				<id xsi:type="xs:decimal">2</id>
			</item>
			<item>
				<value xsi:type="xs:string">ЭТРН</value>
				<id xsi:type="xs:decimal">3</id>
			</item>
		</Value>
	</row>
</ValueTree>