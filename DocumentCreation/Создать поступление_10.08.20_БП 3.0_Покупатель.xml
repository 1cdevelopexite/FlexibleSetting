<ValueTree xmlns="http://v8.1c.ru/8.1/data/core" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="ValueTree">
	<column>
		<Name xsi:type="xs:string">Использовать</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">Кнопка</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">Источник</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">Приемник</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">Служебные</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">Формула</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">СлужебныеТекст</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">Сохранение</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">Загрузка</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">КолонкаИсточника</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">КоллекцияТЧ</Name>
		<ValueType/>
	</column>
	<row>
		<row>
			<Value xsi:type="xs:boolean">true</Value>
			<Value xsi:type="xs:string"/>
			<Value xsi:type="xs:string"/>
			<Value xsi:type="xs:string"/>
			<Value xsi:type="xs:string"/>
			<Value xsi:type="xs:string">Приемник.Заполнить(Источник);</Value>
			<Value xsi:type="xs:string"/>
			<Value xsi:type="xs:decimal">0</Value>
			<Value xsi:type="xs:decimal">0</Value>
			<Value xsi:type="xs:string"/>
			<Value xsi:type="ValueListType">
				<valueType/>
				<lastId xsi:type="xs:decimal">-1</lastId>
			</Value>
		</row>
		<row>
			<Value xsi:type="xs:boolean">true</Value>
			<Value xsi:type="xs:string"/>
			<Value xsi:type="xs:string"/>
			<Value xsi:type="xs:string">Склад</Value>
			<Value xsi:type="xs:string"/>
			<Value xsi:type="xs:string">Склад = Неопределено;
 
Запрос = Новый Запрос;
Запрос.Текст = 
"ВЫБРАТЬ
|	Склады.Ссылка КАК Ссылка
|ИЗ
|	Справочник.Склады КАК Склады
|ГДЕ
|	Склады.Наименование = &amp;Наименование";

Запрос.УстановитьПараметр("Наименование", "Основной склад");
Результат = Запрос.Выполнить();
Если НЕ Результат.Пустой() Тогда 
	    Выборка = Результат.Выбрать();
		Выборка.Следующий();
		Склад = Выборка.Ссылка;
КонецЕсли;

Возврат Склад;</Value>
			<Value xsi:type="xs:string"/>
			<Value xsi:type="xs:decimal">0</Value>
			<Value xsi:type="xs:decimal">0</Value>
			<Value xsi:type="xs:string"/>
			<Value xsi:type="ValueListType">
				<valueType/>
				<lastId xsi:type="xs:decimal">-1</lastId>
			</Value>
		</row>
		<Value xsi:type="xs:boolean">true</Value>
		<Value xsi:type="xs:string">Создать поступление</Value>
		<Value xsi:type="xs:string">Счет от поставщика</Value>
		<Value xsi:type="xs:string">Поступление (акты, накладные)</Value>
		<Value xsi:type="xs:string">ЭКОМ_СоздаватьДокументРеализация1СПроведенным = Настройка_Параметр_Прочитать("ЭКОМ_СоздаватьДокументРеализация1СПроведенным");

// Запишем документ в базу
Если Приемник.Товары.Количество() = 0 Тогда
	Сообщить("Документ ""Поступление товаров"" по заказу № " + Источник.Номер +
	" не создан, т.к. не заполнены товары, возможно документ был сформирован вручную, проверьте поступление к этому заказу.", СтатусСообщения.Важное);
Иначе
    
	Попытка
		Приемник.Записать(?(ЭКОМ_СоздаватьДокументРеализация1СПроведенным, РежимЗаписиДокумента.Проведение, РежимЗаписиДокумента.Запись));
	
		// Поиск документа ЭКОМ
		Запрос = Новый Запрос;
		Запрос.Текст = 
		"ВЫБРАТЬ
		|	ЭКОМ_Документы.Ссылка КАК ЭКОМ_Документ,
		|	ЭКОМ_Документы.НакладнаяДата КАК НакладнаяДата,
		|	ЭКОМ_Документы.НакладнаяНомер КАК НакладнаяНомер
		|ИЗ
		|	Документ.ЭКОМ_Документы КАК ЭКОМ_Документы
		|ГДЕ
		|	ЭКОМ_Документы.Документ1С = &amp;Документ1С
		|	И ЭКОМ_Документы.ВидДокумента = ЗНАЧЕНИЕ(Перечисление.ЭКОМ_ВидыДокументов.DESADV_Входящий)";

		Запрос.УстановитьПараметр("Документ1С", Источник.Ссылка);
		РезультатЗапроса = Запрос.Выполнить();
		Если НЕ РезультатЗапроса.Пустой() Тогда
			Выборка = РезультатЗапроса.Выбрать();
			Выборка.Следующий();
			ЭКОМ_ДокументОбъект = Выборка.ЭКОМ_Документ.ПолучитьОбъект();
			ЭКОМ_ДокументОбъект.ДокументыСвязанные.Очистить();
			Нов = ЭКОМ_ДокументОбъект.ДокументыСвязанные.Добавить();
			Нов.ДокументСвязанный = Приемник.Ссылка;
			ЭКОМ_ДокументОбъект.Записать();
			
			Приемник.НомерВходящегоДокумента = Выборка.НакладнаяНомер; 
			Приемник.ДатаВходящегоДокумента  = Выборка.НакладнаяДата;
			Приемник.Записать();
		КонецЕсли;
		
		Сообщить("Поступление по ЭКОМ документу № " + Источник.Номер + " создана! Номер ПТУ № " + Приемник.Номер);
	Исключение
		Приемник.Записать(РежимЗаписиДокумента.Запись);
		Сообщить("Поступление по документу № " + Источник.Номер + " не создано!!! " + СокрЛП(ОписаниеОшибки()));	
	КонецПопытки;
	
	
КонецЕсли;
</Value>
		<Value xsi:type="xs:string"/>
		<Value xsi:type="xs:string"/>
		<Value xsi:type="xs:decimal">0</Value>
		<Value xsi:type="xs:decimal">0</Value>
		<Value xsi:type="xs:string">ДокументЗаказа</Value>
		<Value xsi:type="ValueListType">
			<valueType/>
			<lastId xsi:type="xs:decimal">-1</lastId>
		</Value>
	</row>
</ValueTree>