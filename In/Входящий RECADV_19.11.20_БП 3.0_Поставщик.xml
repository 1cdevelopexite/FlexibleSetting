<ValueTree xmlns="http://v8.1c.ru/8.1/data/core" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="ValueTree">
	<column>
		<Name xsi:type="xs:string">Использовать</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">ТипТранзакции</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">Служебные</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">СлужебныеТекст</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">Сохранение</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">Загрузка</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">Кнопка</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">КоллекцияТЧ</Name>
		<ValueType/>
	</column>
	<row>
		<Value xsi:type="xs:boolean">true</Value>
		<Value xsi:type="xs:string">Входящий RECADV</Value>
		<Value xsi:type="xs:string">ПерезаписыватьРеализациюПриНаличииРасхожденийВRECADV = Истина;

ЕстьРасхождения = Ложь;

//Валюта
xmlВалюта = Приемник.xmlВалюта;
Если xmlВалюта = Неопределено Тогда
	xmlВалюта = "RUB";
КонецЕсли;

Если Приемник.xmlВалюта = "RUB" Тогда
	Валюта = Справочники.Валюты.НайтиПоКоду(643);
ИначеЕсли Приемник.xmlВалюта = "KZT" Тогда
	Валюта = Справочники.Валюты.НайтиПоКоду(398);
ИначеЕсли Приемник.xmlВалюта = "BYR" Тогда
	Валюта = Справочники.Валюты.НайтиПоКоду(974);
ИначеЕсли Приемник.xmlВалюта = "UAH" Тогда
	Валюта = Справочники.Валюты.НайтиПоКоду(980);
ИначеЕсли Приемник.xmlВалюта = "MDL" Тогда
	Валюта = Справочники.Валюты.НайтиПоКоду(498);
ИначеЕсли Приемник.xmlВалюта = "EUR" Тогда
	Валюта = Справочники.Валюты.НайтиПоКоду(978);
ИначеЕсли Приемник.xmlВалюта = "USD" Тогда
	Валюта = Справочники.Валюты.НайтиПоКоду(840);
Иначе
	Валюта = Справочники.Валюты.НайтиПоКоду(643);
КонецЕсли;

Приемник.Валюта = Валюта;

Для Каждого ТекущаяСтрокаТЧ Из Приемник.ТЧ_Товары Цикл
	
	ТекущаяСтрокаТЧ.КоличествоИз1С = ТекущаяСтрокаТЧ.КоличествоЗаказанное;
	
	Если ТекущаяСтрокаТЧ.КоличествоЗаказанное &lt;&gt; ТекущаяСтрокаТЧ.КоличествоПринятое Тогда
		ЕстьРасхождения = Истина;
	КонецЕсли;
	
КонецЦикла;

Если ПерезаписыватьРеализациюПриНаличииРасхожденийВRECADV Тогда
	
	Если ЕстьРасхождения = Истина Тогда
		
		НаборЗаписей = РегистрыСведений.ЭКОМ_ЦепочкиДокументовПоставщика.СоздатьНаборЗаписей();
		Если ЗначениеЗаполнено(Приемник.НакладнаяДата) Тогда
			НаборЗаписей.Отбор.DESADVDATE.Установить(Приемник.НакладнаяДата);
		КонецЕсли;
		НаборЗаписей.Отбор.DESADVNUMBER.Установить(Приемник.НакладнаяНомер);
		НаборЗаписей.Отбор.Организация.Установить(Приемник.Организация);
		НаборЗаписей.Отбор.Контрагент.Установить(Приемник.Контрагент);
		НаборЗаписей.Отбор.ТочкаДоставки.Установить(Приемник.ТочкаДоставки);
		
		НаборЗаписей.Прочитать();
		
		Если НаборЗаписей.Количество() = 1 Тогда 
			НайденнаяЦепочкаДокументов = НаборЗаписей[0];
			РТУ = НайденнаяЦепочкаДокументов.Накладная;
		КонецЕсли;
		
		Если ЗначениеЗаполнено(РТУ) Тогда
			
			РТУОбъект = РТУ.ПолучитьОбъект();
			
			// В случае расхождений перезапишем РТУ
			Для Каждого ТекущаяСтрокаRECADV Из Приемник.ТЧ_Товары Цикл
				
				Если ТекущаяСтрокаRECADV.КоличествоЗаказанное &lt;&gt; ТекущаяСтрокаRECADV.КоличествоПринятое Тогда
					
					СтрокаРТУ = РТУОбъект.Товары.Найти(ТекущаяСтрокаRECADV.Номенклатура, "Номенклатура");
					Если ЗначениеЗаполнено(СтрокаРТУ) Тогда
						
						Если ТекущаяСтрокаRECADV.КоличествоПринятое = 0 Тогда
							ИндексСтроки = РТУОбъект.Товары.Индекс(СтрокаРТУ);
							РТУОбъект.Товары.Удалить(ИндексСтроки);
							Продолжить;
						КонецЕсли;
						
						
						СтрокаРТУ.Количество = ТекущаяСтрокаRECADV.КоличествоПринятое;
						СтрокаРТУ.Сумма = СтрокаРТУ.Количество * СтрокаРТУ.Цена;
						
						ФорматУПД = м_ПолучитьФорматКонтрагента(РТУОбъект.Контрагент);
						ИспользоватьОбратныйПорядокРасчетаСумм = НуженОбратныйРасчетСумм(ФорматУПД);
						СтруктураРасчета = РасчетСумм(СтрокаРТУ.Цена, СтавкаНДСЧислом(СтрокаРТУ.СтавкаНДС), РТУОбъект.СуммаВключаетНДС, СтрокаРТУ.Количество, 
						ИспользоватьОбратныйПорядокРасчетаСумм);		
						СтрокаРТУ.СуммаНДС = СтруктураРасчета.СуммаНДС;
						
					КонецЕсли;
					
				КонецЕсли;
				
			КонецЦикла;
			
			РТУОбъект.Записать();
			
		КонецЕсли;
		
		Сообщить("Скорректированы расхождения в " + РТУ);
	КонецЕсли;
	
КонецЕсли;

/////////////////////////////////////////////////////////////////////////////////////////
// Регистрация RECADV в цепочке документов поставщика

Приемник.Записать();

НаборЗаписей = РегистрыСведений.ЭКОМ_ЦепочкиДокументовПоставщика.СоздатьНаборЗаписей();
Если ЗначениеЗаполнено(Приемник.НакладнаяДата) Тогда
	НаборЗаписей.Отбор.DESADVDATE.Установить(Приемник.НакладнаяДата);
КонецЕсли;
НаборЗаписей.Отбор.DESADVNUMBER.Установить(Приемник.НакладнаяНомер);
НаборЗаписей.Отбор.Организация.Установить(Приемник.Организация);
НаборЗаписей.Отбор.Контрагент.Установить(Приемник.Контрагент);
НаборЗаписей.Отбор.ТочкаДоставки.Установить(Приемник.ТочкаДоставки);

НаборЗаписей.Прочитать();

Если НаборЗаписей.Количество() &gt; 1 Тогда
	Сообщить("Найдено две или более цепочки документов с номером DESADV " + Приемник.НакладнаяНомер + ". Необходимо устранить дублирование документов.");
ИначеЕсли НаборЗаписей.Количество() = 1 Тогда
	НайденнаяЦепочкаДокументов = НаборЗаписей[0];
	
	НайденнаяЦепочкаДокументов.RECADV  = Приемник.Ссылка;
	
	НайденнаяЦепочкаДокументов.КоличествоRECADV = Приемник.ТЧ_Товары.Итог("КоличествоПринятое");
	НайденнаяЦепочкаДокументов.СуммаRECADV = Приемник.ТЧ_Товары.Итог("Сумма_с_НДС");
КонецЕсли;

НаборЗаписей.Записать();
/////////////////////////////////////////////////////////////////////////////////////////</Value>
		<Value xsi:type="xs:string"/>
		<Value xsi:type="xs:decimal">0</Value>
		<Value xsi:type="xs:decimal">0</Value>
		<Value xsi:type="xs:string">Уведомление о приемке (RECADV)</Value>
		<Value xsi:type="ValueListType">
			<valueType/>
			<lastId xsi:type="xs:decimal">-1</lastId>
		</Value>
	</row>
</ValueTree>